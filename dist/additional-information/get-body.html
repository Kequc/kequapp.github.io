<!DOCTYPE html>
<html lang="en" class="h-full">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>getBody - Kequapp Documentation</title>
    <link href="/assets/style.css" rel="stylesheet">
</head>

<body class="flex flex-col min-h-full bg-gray-100">
    <header class="bg-green-600 text-white p-4 shadow-md">
        <div class="container mx-auto max-w-7xl flex justify-between items-center">
            <div class="flex items-center space-x-4 pl-2">
                <div class="flex flex-col">
                    <p class="text-sm italic">\ `hek-y√º-ap \</p>
                    <span class="text-xs">Version: 0.7.0</span>
                </div>
            </div>
            <div class="flex items-center space-x-8">
                <div class="flex items-center space-x-2">
                    <a href="https://github.com/Kequc/kequapp" target="_blank" rel="noopener noreferrer" class="text-white hover:text-green-200 block p-2" title="GitHub">
                        <svg class="h-6 w-6" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12" />
                        </svg>
                    </a>
                    <a href="https://www.npmjs.com/package/kequapp" target="_blank" rel="noopener noreferrer" class="text-white hover:text-green-200 block p-2" title="Npm">
                        <svg class="h-6 w-6" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M0 7.334v8h6.666v1.332H12v-1.332h12v-8H0zm6.666 6.664H5.334v-4H3.999v4H1.335V8.667h5.331v5.331zm4 0v1.336H8.001V8.667h5.334v5.332h-2.669v-.001zm12.001 0h-1.33v-4h-1.336v4h-1.335v-4h-1.33v4h-2.671V8.667h8.002v5.331zM10.665 10H12v2.667h-1.335V10z" />
                        </svg>
                    </a>
                </div>
                <div id="search-container" class="relative w-64">
                    <input type="text" id="search-input" placeholder="Search..." class="w-full px-4 py-2 rounded-md text-gray-900 focus:outline-none focus:ring-2 focus:ring-green-500">
                    <ul id="search-results" class="absolute z-10 w-full mt-1 bg-white rounded-md shadow-lg max-h-60 overflow-auto hidden"></ul>
                </div>
            </div>
        </div>
    </header>
    <div class="flex-grow container mx-auto max-w-7xl flex">
        <aside class="w-72 bg-white shadow-md">
            <nav class="p-6 sticky top-0">
                <a class="mb-6" href="/">
                    <img src="/assets/logo.png" alt="Kequapp Logo" class="w-28">
                </a>
                <h3 class="font-bold text-lg mt-4 mb-2">Docs</h3>
                <ul>
                    <li>
                        <a href="/docs/basic-concepts.html" class="text-gray-700 hover:text-green-600 w-full block py-1">
                            Basic Concepts
                        </a>
                    </li>
                </ul>
                <h3 class="font-bold text-lg mt-4 mb-2">Getting Started</h3>
                <ul>
                    <li>
                        <a href="/getting-started/installation.html" class="text-gray-700 hover:text-green-600 w-full block py-1">
                            Installation
                        </a>
                    </li>
                    <li>
                        <a href="/getting-started/hello-world-example.html" class="text-gray-700 hover:text-green-600 w-full block py-1">
                            Hello World Example
                        </a>
                    </li>
                </ul>
                <h3 class="font-bold text-lg mt-4 mb-2">Core Api</h3>
                <ul>
                    <li>
                        <a href="/core-api/create-app.html" class="text-gray-700 hover:text-green-600 w-full block py-1">
                            createApp
                        </a>
                    </li>
                    <li>
                        <a href="/core-api/create-branch.html" class="text-gray-700 hover:text-green-600 w-full block py-1">
                            createBranch
                        </a>
                    </li>
                    <li>
                        <a href="/core-api/create-route.html" class="text-gray-700 hover:text-green-600 w-full block py-1">
                            createRoute
                        </a>
                    </li>
                    <li>
                        <a href="/core-api/create-handle.html" class="text-gray-700 hover:text-green-600 w-full block py-1">
                            createHandle
                        </a>
                    </li>
                    <li>
                        <a href="/core-api/create-error-handler.html" class="text-gray-700 hover:text-green-600 w-full block py-1">
                            createErrorHandler
                        </a>
                    </li>
                    <li>
                        <a href="/core-api/create-renderer.html" class="text-gray-700 hover:text-green-600 w-full block py-1">
                            createRenderer
                        </a>
                    </li>
                </ul>
                <h3 class="font-bold text-lg mt-4 mb-2">Advanced Usage</h3>
                <ul>
                    <li>
                        <a href="/advanced-usage/responding-to-requests.html" class="text-gray-700 hover:text-green-600 w-full block py-1">
                            Responding to Requests
                        </a>
                    </li>
                    <li>
                        <a href="/advanced-usage/cors-and-options-requests.html" class="text-gray-700 hover:text-green-600 w-full block py-1">
                            CORS and OPTIONS Requests
                        </a>
                    </li>
                    <li>
                        <a href="/advanced-usage/head-requests.html" class="text-gray-700 hover:text-green-600 w-full block py-1">
                            HEAD Requests
                        </a>
                    </li>
                </ul>
                <h3 class="font-bold text-lg mt-4 mb-2">Utilities</h3>
                <ul>
                    <li>
                        <a href="/utilities/ex.html" class="text-gray-700 hover:text-green-600 w-full block py-1">
                            Ex
                        </a>
                    </li>
                    <li>
                        <a href="/utilities/static-directory.html" class="text-gray-700 hover:text-green-600 w-full block py-1">
                            staticDirectory
                        </a>
                    </li>
                    <li>
                        <a href="/utilities/send-file.html" class="text-gray-700 hover:text-green-600 w-full block py-1">
                            sendFile
                        </a>
                    </li>
                    <li>
                        <a href="/utilities/inject.html" class="text-gray-700 hover:text-green-600 w-full block py-1">
                            inject
                        </a>
                    </li>
                </ul>
                <h3 class="font-bold text-lg mt-4 mb-2">Additional Information</h3>
                <ul>
                    <li>
                        <a href="/additional-information/bundle-properties.html" class="text-gray-700 hover:text-green-600 w-full block py-1">
                            Bundle Properties
                        </a>
                    </li>
                    <li>
                        <a href="/additional-information/get-body.html" class="text-green-600 font-medium w-full block py-1">
                            getBody
                        </a>
                    </li>
                    <li>
                        <a href="/additional-information/logger.html" class="text-gray-700 hover:text-green-600 w-full block py-1">
                            Logger
                        </a>
                    </li>
                    <li>
                        <a href="/additional-information/conclusion.html" class="text-gray-700 hover:text-green-600 w-full block py-1">
                            Conclusion
                        </a>
                    </li>
                </ul>
            </nav>
        </aside>
        <main class="flex-grow p-8">
            <div class="max-w-3xl">
                <h1 class="text-3xl font-bold mb-6">getBody</h1>
                <div class="prose max-w-none mb-24">
                    <p>Node delivers the body of a request in chunks.</p>
                    <p>It is not necessary to wait for the request to finish before we begin processing it. In most cases, we just want the data and therefore a helper method <code>getBody()</code> is provided which we may use to await body parameters from the completed request.</p>
                    <pre><code class="language-javascript">// getBody

createRoute({
    method: &#39;POST&#39;,
    url: &#39;/users&#39;,
    handles: [async ({ getBody }) =&gt; {
        const body = await getBody();

        // body ~= {
        //     name: &#39;April&#39;
        // }

        return \`User creation \${body.name}!\`;
    }]
});
</code></pre>
                    <p>It takes an options object which can be used to parse and normalize a client request into useful data in a large assortment of different ways.</p>
                    <h3>multipart</h3>
                    <p>Causes the method to return both <code>body</code> and <code>files</code>. If the client didn&#39;t send any files, or it wasn&#39;t a multipart request the second parameter will be an empty array.</p>
                    <pre><code class="language-javascript">// multipart

createRoute({
    method: &#39;POST&#39;,
    url: &#39;/users&#39;,
    handles: [async ({ getBody }) =&gt; {
        const [body, files] = await getBody({ multipart: true });

        // body ~= {
        //     name: &#39;April&#39;
        // }
        // files ~= [{
        //     headers: {
        //         &#39;content-disposition&#39;: &#39;form-data; name=&quot;avatar&quot; filename=&quot;my-cat.png&quot;&#39;,
        //         &#39;content-type&#39;: &#39;image/png;&#39;
        //     },
        //     contentType: &#39;image/png&#39;,
        //     name: &#39;avatar&#39;,
        //     filename: &#39;my-cat.png&#39;,
        //     data: Buffer &lt;...&gt;
        // }]

        return \`User creation \${body.name}!\`;
    }]
});
</code></pre>
                    <h3>raw</h3>
                    <p>Causes the body to be processed as minimally as possible and return a single buffer. This is especially useful when our application expects a content type other than <code>&#39;application/x-www-form-urlencoded&#39;</code>, <code>&#39;application/json&#39;</code>, or <code>&#39;multipart/form-data&#39;</code>.</p>
                    <pre><code class="language-javascript">// raw

createRoute({
    method: &#39;POST&#39;,
    url: &#39;/users&#39;,
    handles: [async ({ getBody }) =&gt; {
        const data = await getBody({ raw: true });

        // data ~= Buffer &lt;...&gt;

        return &#39;Image received!&#39;;
    }]
});
</code></pre>
                    <p>When combined with <code>multipart</code>, the body is parsed into an array of separate buffers with their respective headers.</p>
                    <pre><code class="language-javascript">// raw

createRoute({
    method: &#39;POST&#39;,
    url: &#39;/users&#39;,
    handles: [async ({ getBody }) =&gt; {
        const parts = await getBody({ raw: true, multipart: true });

        // parts ~= [{
        //     headers: {
        //         &#39;content-disposition&#39;: &#39;form-data; name=&quot;name&quot;&#39;
        //     },
        //     data: Buffer &lt;...&gt;
        // }, {
        //     headers: {
        //         &#39;content-disposition&#39;: &#39;form-data; name=&quot;avatar&quot; filename=&quot;my-cat.png&quot;&#39;,
        //         &#39;content-type&#39;: &#39;image/png;&#39;
        //     },
        //     data: Buffer &lt;...&gt;
        // }]

        return \`User creation \${parts[0].data.toString()}!\`;
    }]
});
</code></pre>
                    <h3>skipNormalize</h3>
                    <p>By default, the data received is pushed through some body normalization. This is so that the body we receive is in a format we expect and is therefore easier to work with. Normalization is directed by <code>arrays</code>, <code>required</code>, <code>numbers</code>, <code>booleans</code>, and <code>validate</code>.</p>
                    <p>Disable body normalization with either <code>raw</code> or <code>skipNormalize</code>.</p>
                    <h3>arrays</h3>
                    <p>The provided list of fields are converted into arrays.</p>
                    <p>Fields that are not specified will return only the first value. This is because the framework only knows that a field is an array when it receives more than one value for a given name from the client. It would be inconvenient if parameters are sometimes arrays, and therefore we are explicit.</p>
                    <pre><code class="language-javascript">// arrays

createRoute({
    method: &#39;POST&#39;,
    url: &#39;/users&#39;,
    handles: [async ({ getBody }) =&gt; {
        const body = await getBody({
            arrays: [&#39;ownedPets&#39;]
        });

        // body ~= {
        //     ownedPets: [&#39;cat&#39;],
        //     age: &#39;23&#39;,
        //     name: &#39;April&#39;
        // }
    }]
});
</code></pre>
                    <h3>required</h3>
                    <p>The provided list of fields are not <code>null</code> or <code>undefined</code>. It&#39;s a quick way to throw a <code>422 Unprocessable Entity</code> error. These fields might still be empty, but at least something was sent and we know we can operate on them. When a <code>required</code> field is also an <code>arrays</code> field the array is sure to have at least one value.</p>
                    <h3>numbers</h3>
                    <p>The provided list of fields will throw a <code>422 Unprocessable Entity</code> error if any value is provided which parses into <code>NaN</code>. Otherwise they are converted into numbers.</p>
                    <p>When a <code>numbers</code> field is also an <code>arrays</code> field the array is all numbers.</p>
                    <h3>booleans</h3>
                    <p>The provided list of fields are converted into <code>false</code> if the value is falsy, <code>&#39;0&#39;</code>, or <code>&#39;false&#39;</code> (case insensitive), otherwise <code>true</code>. When a <code>booleans</code> field is also an <code>arrays</code> field the array is all booleans. When a <code>booleans</code> field is also a <code>numbers</code> field the value is first converted to a number and then to a boolean this is not recommended.</p>
                    <h3>validate</h3>
                    <p>After normalization, this method further ensures the validity of the data. Returning anything throws a <code>422 Unprocessable Entity</code> error.</p>
                    <pre><code class="language-javascript">// validate

interface TBody {
    ownedPets: string[];
    age: number;
    name: string;
}

createRoute({
    method: &#39;POST&#39;,
    url: &#39;/users&#39;,
    handles: [async ({ getBody }) =&gt; {
        const body = await getBody&lt;TBody&gt;({
            arrays: [&#39;ownedPets&#39;],
            required: [&#39;age&#39;, &#39;name&#39;],
            numbers: [&#39;age&#39;],
            validate (result) {
                if (result.ownedPets.length &gt; 99) {
                    return &#39;Too many pets&#39;;
                }
                if (result.name.length &lt; 3) {
                    return &#39;Name is too short&#39;;
                }
            }
        });

        // body ~= {
        //     ownedPets: [&#39;Maggie&#39;, &#39;Ralph&#39;],
        //     age: 23,
        //     name: &#39;April&#39;
        // }
    }]
});
</code></pre>
                    <p>We know it is safe to use <code>result.ownedPets.length</code> in this example because it is listed as an <code>arrays</code> field and therefore certain to be an array. <code>result.name</code> is also safe to use because it is listed as a <code>required</code> field and therefore certain to exist.</p>
                </div>
            </div>
        </main>
    </div>
    <footer class="bg-gray-200 text-center p-4 mt-auto">
        <p class="text-gray-600">&copy; 2024 Kequapp. All rights reserved.</p>
    </footer>
    <script src="/assets/search.js" defer></script>
</body>

</html>